colnames(Sr9b_CC_prop) <- c("GOID", "Annotated", "Significant", "Expected")
Sr9b_CCresults_score <- score(Sr9b_CCresults)
Sr9b_CCresults_score <- as.data.frame(Sr9b_CCresults_score)
setDT(Sr9b_CCresults_score, keep.rownames = TRUE)[]
colnames(Sr9b_CCresults_score) <- c("GOID", "FISHERSCORE")
Sr9b_CC_combined_results <- left_join(Sr9b_CCresults_score, Sr9b_CC_prop, by = "GOID")
Sr9b_CC_combined_results
})
Sr9b_CCresults_final <- lapply(Sr9b_CCslim_results_list, function(b) {
b[FISHERSCORE < 0.01]
})
genotype_list <- rep("Sr9b", 6)
day_list <- c(2,2,4,4,6,6)
direction_list <-c("down","up","down","up","down","up")
domain_list <- rep("CC", 6)
for(m in 1:6) {
Sr9b_CCresults_final[[m]]$genotype <- rep(genotype_list[[m]], length(Sr9b_CCresults_final[[m]]$GOID))
Sr9b_CCresults_final[[m]]$day <- rep(day_list[[m]], length(Sr9b_CCresults_final[[m]]$GOID))
Sr9b_CCresults_final[[m]]$direction <- rep(direction_list[[m]], length(Sr9b_CCresults_final[[m]]$GOID))
Sr9b_CCresults_final[[m]]$domain <- rep(domain_list[[m]], length(Sr9b_CCresults_final[[m]]$GOID))
}
## Sr9b BP
Sr9b_BPslim_results_list <- lapply(Sr9b_genelist, function(a) {
Sr9b_BPGOdata <- new("topGOdata", description = "Sr9b_BPslim", ontology = "BP", allGenes = a, annot = annFUN.gene2GO, gene2GO = wheatGENESLIM2GO)
Sr9b_BPresults <- runTest(Sr9b_BPGOdata, algorithm = "weight01", statistic = "fisher")
Sr9b_BP_prop <- termStat(Sr9b_BPGOdata)
setDT(Sr9b_BP_prop, keep.rownames = TRUE)
colnames(Sr9b_BP_prop) <- c("GOID", "Annotated", "Significant", "Expected")
Sr9b_BPresults_score <- score(Sr9b_BPresults)
Sr9b_BPresults_score <- as.data.frame(Sr9b_BPresults_score)
setDT(Sr9b_BPresults_score, keep.rownames = TRUE)[]
colnames(Sr9b_BPresults_score) <- c("GOID", "FISHERSCORE")
Sr9b_BP_combined_results <- left_join(Sr9b_BPresults_score, Sr9b_BP_prop, by = "GOID")
Sr9b_BP_combined_results
})
Sr9b_BPresults_final <- lapply(Sr9b_BPslim_results_list, function(b) {
b[FISHERSCORE < 0.01]
})
genotype_list <- rep("Sr9b", 6)
day_list <- c(2,2,4,4,6,6)
direction_list <-c("down","up","down","up","down","up")
domain_list <- rep("BP", 6)
for(m in 1:6) {
Sr9b_BPresults_final[[m]]$genotype <- rep(genotype_list[[m]], length(Sr9b_BPresults_final[[m]]$GOID))
Sr9b_BPresults_final[[m]]$day <- rep(day_list[[m]], length(Sr9b_BPresults_final[[m]]$GOID))
Sr9b_BPresults_final[[m]]$direction <- rep(direction_list[[m]], length(Sr9b_BPresults_final[[m]]$GOID))
Sr9b_BPresults_final[[m]]$domain <- rep(domain_list[[m]], length(Sr9b_BPresults_final[[m]]$GOID))
}
all_brachy_CC <- bind_rows(brachy_CC_results_final)
all_brachy_MF <- bind_rows(brachy_results_final)
all_W2691_MF <- bind_rows(W2691_results_final)
all_W2691_CC <- bind_rows(W2691_CCresults_final)
all_W2691_BP <- bind_rows(W2691_BPresults_final)
all_Sr9b_MF <- bind_rows(Sr9b_results_final)
all_Sr9b_CC <- bind_rows(Sr9b_CCresults_final)
all_Sr9b_BP <- bind_rows(Sr9b_BPresults_final)
all_results <- rbind(all_brachy_MF, all_brachy_CC, all_W2691_MF, all_W2691_CC, all_W2691_BP, all_Sr9b_MF, all_Sr9b_CC, all_Sr9b_BP)
all_results_w_go_descriptions <- left_join(x = all_results, y = goterms, by = "GOID")
all_results_w_go_descriptions$day <- as.factor(all_results_w_go_descriptions$day)
all_results_w_go_descriptions$genotype <- as.factor(all_results_w_go_descriptions$genotype)
all_results_w_go_descriptions$genotype <- factor(all_results_w_go_descriptions$genotype, levels=c("W2691", "Sr9b", "Bd21-3"))
levels(all_results_w_go_descriptions$genotype) = c("W2691"=expression(paste("W2691")), "Sr9b"=expression(paste("W2691+", italic("Sr9b"))), "Bd21-3"=expression(paste("Bd21-3")))
all_results_w_go_descriptions$GOTERM <- as.factor(all_results_w_go_descriptions$GOTERM)
all_results_w_go_descriptions$OoverE <- all_results_w_go_descriptions$Significant/all_results_w_go_descriptions$Expected
all_results_w_go_descriptions$OoverALL <- all_results_w_go_descriptions$Significant/all_results_w_go_descriptions$Annotated
colnames(all_results_w_go_descriptions)[7] <- "dpi"
all_results_w_go_descriptions$direction <- as.factor(all_results_w_go_descriptions$direction)
all_results_w_go_descriptions$direction <- factor(all_results_w_go_descriptions$direction, levels = c("up", "down"))
ggplot(all_results_w_go_descriptions, aes(x=dpi, y=GOTERM, fill=OoverALL)) +
geom_tile(width=1, height=1) +
scale_fill_gradient2(low = "white", mid = "pink", high = "red", space = "Lab", name = "Significant:Annotated", breaks = c(0.001, 0.05, 0.1 ,0.15), labels = c("0", "0.05", "0.1", "0.15"), limits = c(0,0.15)) +
facet_grid(direction + domain ~ genotype, scales = "free_y", labeller = label_parsed) +
theme(
axis.text.x = element_text(size = 10, color="black"),
axis.title = element_text(size = 10),
axis.text.y = element_text(size=8, color="black"),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank(),
panel.grid.major = element_line(color = "gray"),
panel.grid.minor = element_blank(),
#panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill = "transparent", color = "white", size = 1),
#strip.text = element_text(face = "bold", size = 10, color = "black"),
strip.text = element_text(size = 10, color = "black"),
legend.position = "bottom",
legend.justification = "right",
legend.box = "horizontal",
#legend.box.background = element_rect(colour = "black"),
#legend.background = element_blank(),
panel.border = element_rect(color = "gray", fill = NA, size = 0.5),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
legend.background = element_rect(fill = "transparent"),
#legend.box.background = element_rect(fill = "transparent"),
legend.box.background=element_blank(),
legend.text=element_text(size=10),
legend.title=element_text(size=10),
strip.text.x=element_text(size=10),
legend.key.height = unit(0.1, "in"))
ggplot(all_results_w_go_descriptions, aes(x=dpi, y=GOTERM, fill=OoverALL)) +
geom_tile(width=1, height=1) +
scale_fill_gradient2(low = "white", mid = "pink", high = "red", space = "Lab", name = "Significant:Annotated", breaks = c(0, 0.05, 0.1 ,0.15), labels = c("0.001", "0.05", "0.1", "0.15"), limits = c(0,0.15)) +
facet_grid(direction + domain ~ genotype, scales = "free_y", labeller = label_parsed) +
theme(
axis.text.x = element_text(size = 10, color="black"),
axis.title = element_text(size = 10),
axis.text.y = element_text(size=8, color="black"),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank(),
panel.grid.major = element_line(color = "gray"),
panel.grid.minor = element_blank(),
#panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill = "transparent", color = "white", size = 1),
#strip.text = element_text(face = "bold", size = 10, color = "black"),
strip.text = element_text(size = 10, color = "black"),
legend.position = "bottom",
legend.justification = "right",
legend.box = "horizontal",
#legend.box.background = element_rect(colour = "black"),
#legend.background = element_blank(),
panel.border = element_rect(color = "gray", fill = NA, size = 0.5),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
legend.background = element_rect(fill = "transparent"),
#legend.box.background = element_rect(fill = "transparent"),
legend.box.background=element_blank(),
legend.text=element_text(size=10),
legend.title=element_text(size=10),
strip.text.x=element_text(size=10),
legend.key.height = unit(0.1, "in"))
## For next time: fix font size and scale for printing
topgo_figure2 <- ggplot(all_results_w_go_descriptions, aes(x=dpi, y=GOTERM, fill=OoverALL)) +
geom_tile(width=1, height=1) +
scale_fill_gradient2(low = "white", mid = "pink", high = "red", space = "Lab", name = "Sig:Ann", breaks = c(0, 0.05, 0.1 ,0.15), labels = c("0.001", "0.05", "0.1", "0.15"), limits = c(0,0.15)) +
facet_grid(direction + domain ~ genotype, scales = "free_y", labeller = label_parsed) +
theme(
axis.text.x = element_text(size = 10, color="black"),
axis.title = element_text(size = 10),
axis.text.y = element_text(size=8, color="black"),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank(),
panel.grid.major = element_line(color = "gray"),
panel.grid.minor = element_blank(),
#panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill = "transparent", color = "white", size = 1),
#strip.text = element_text(face = "bold", size = 10, color = "black"),
strip.text = element_text(size = 10, color = "black"),
legend.position = "bottom",
legend.justification = "right",
legend.box = "horizontal",
#legend.box.background = element_rect(colour = "black"),
#legend.background = element_blank(),
panel.border = element_rect(color = "gray", fill = NA, size = 0.5),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
legend.background = element_rect(fill = "transparent"),
#legend.box.background = element_rect(fill = "transparent"),
legend.box.background=element_blank(),
legend.text=element_text(size=10),
legend.title=element_text(size=10),
strip.text.x=element_text(size=10),
legend.key.height = unit(0.1, "in"))
figure2_plot_more = ggplot_gtable(ggplot_build(topgo_figure2))
#gtable_show_layout(figure2_plot_more)
figure2_plot_more$heights[17] <- 0*figure2_plot_more$heights[17]
as_ggplot(figure2_plot_more)
min(all_results_w_go_descriptions$OoverALL)
max(all_results_w_go_descriptions$OoverALL)
0.1248313-0.004634506
0.1201968/2
## For next time: fix font size and scale for printing
topgo_figure2 <- ggplot(all_results_w_go_descriptions, aes(x=dpi, y=GOTERM, fill=OoverALL)) +
geom_tile(width=1, height=1) +
scale_fill_gradient2(low = "white", mid = "pink", high = "red", midpoint = 0.06, space = "Lab", name = "Sig:Ann", breaks = c(0, 0.05, 0.1 ,0.15), labels = c("0.001", "0.05", "0.1", "0.15"), limits = c(0,0.15)) +
facet_grid(direction + domain ~ genotype, scales = "free_y", labeller = label_parsed) +
theme(
axis.text.x = element_text(size = 10, color="black"),
axis.title = element_text(size = 10),
axis.text.y = element_text(size=8, color="black"),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank(),
panel.grid.major = element_line(color = "gray"),
panel.grid.minor = element_blank(),
#panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill = "transparent", color = "white", size = 1),
#strip.text = element_text(face = "bold", size = 10, color = "black"),
strip.text = element_text(size = 10, color = "black"),
legend.position = "bottom",
legend.justification = "right",
legend.box = "horizontal",
#legend.box.background = element_rect(colour = "black"),
#legend.background = element_blank(),
panel.border = element_rect(color = "gray", fill = NA, size = 0.5),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
legend.background = element_rect(fill = "transparent"),
#legend.box.background = element_rect(fill = "transparent"),
legend.box.background=element_blank(),
legend.text=element_text(size=10),
legend.title=element_text(size=10),
strip.text.x=element_text(size=10),
legend.key.height = unit(0.1, "in"))
figure2_plot_more = ggplot_gtable(ggplot_build(topgo_figure2))
#gtable_show_layout(figure2_plot_more)
figure2_plot_more$heights[17] <- 0*figure2_plot_more$heights[17]
as_ggplot(figure2_plot_more)
## For next time: fix font size and scale for printing
topgo_figure2 <- ggplot(all_results_w_go_descriptions, aes(x=dpi, y=GOTERM, fill=OoverALL)) +
geom_tile(width=1, height=1) +
scale_fill_gradient2(low = "white", mid = "pink", high = "red", midpoint = 0.03, space = "Lab", name = "Sig:Ann", breaks = c(0, 0.05, 0.1 ,0.15), labels = c("0.001", "0.05", "0.1", "0.15"), limits = c(0,0.15)) +
facet_grid(direction + domain ~ genotype, scales = "free_y", labeller = label_parsed) +
theme(
axis.text.x = element_text(size = 10, color="black"),
axis.title = element_text(size = 10),
axis.text.y = element_text(size=8, color="black"),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank(),
panel.grid.major = element_line(color = "gray"),
panel.grid.minor = element_blank(),
#panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill = "transparent", color = "white", size = 1),
#strip.text = element_text(face = "bold", size = 10, color = "black"),
strip.text = element_text(size = 10, color = "black"),
legend.position = "bottom",
legend.justification = "right",
legend.box = "horizontal",
#legend.box.background = element_rect(colour = "black"),
#legend.background = element_blank(),
panel.border = element_rect(color = "gray", fill = NA, size = 0.5),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
legend.background = element_rect(fill = "transparent"),
#legend.box.background = element_rect(fill = "transparent"),
legend.box.background=element_blank(),
legend.text=element_text(size=10),
legend.title=element_text(size=10),
strip.text.x=element_text(size=10),
legend.key.height = unit(0.1, "in"))
figure2_plot_more = ggplot_gtable(ggplot_build(topgo_figure2))
#gtable_show_layout(figure2_plot_more)
figure2_plot_more$heights[17] <- 0*figure2_plot_more$heights[17]
as_ggplot(figure2_plot_more)
## For next time: fix font size and scale for printing
topgo_figure2 <- ggplot(all_results_w_go_descriptions, aes(x=dpi, y=GOTERM, fill=OoverALL)) +
geom_tile(width=1, height=1) +
scale_fill_gradient2(low = "white", mid = "grey", high = "black", midpoint = 0.03, space = "Lab", name = "Sig:Ann", breaks = c(0, 0.05, 0.1 ,0.15), labels = c("0.001", "0.05", "0.1", "0.15"), limits = c(0,0.15)) +
facet_grid(direction + domain ~ genotype, scales = "free_y", labeller = label_parsed) +
theme(
axis.text.x = element_text(size = 10, color="black"),
axis.title = element_text(size = 10),
axis.text.y = element_text(size=8, color="black"),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank(),
panel.grid.major = element_line(color = "gray"),
panel.grid.minor = element_blank(),
#panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill = "transparent", color = "white", size = 1),
#strip.text = element_text(face = "bold", size = 10, color = "black"),
strip.text = element_text(size = 10, color = "black"),
legend.position = "bottom",
legend.justification = "right",
legend.box = "horizontal",
#legend.box.background = element_rect(colour = "black"),
#legend.background = element_blank(),
panel.border = element_rect(color = "gray", fill = NA, size = 0.5),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
legend.background = element_rect(fill = "transparent"),
#legend.box.background = element_rect(fill = "transparent"),
legend.box.background=element_blank(),
legend.text=element_text(size=10),
legend.title=element_text(size=10),
strip.text.x=element_text(size=10),
legend.key.height = unit(0.1, "in"))
figure2_plot_more = ggplot_gtable(ggplot_build(topgo_figure2))
#gtable_show_layout(figure2_plot_more)
figure2_plot_more$heights[17] <- 0*figure2_plot_more$heights[17]
as_ggplot(figure2_plot_more)
ggsave(filename = "/Users/evahenningsen/Documents/GitHub/stem_rust_susceptibility/figure_2/Fig_2_GOSLIM_bw.pdf", plot = figure2_plot_more, device = "pdf", width= 7.08, height=5, units = "in")
## For next time: fix font size and scale for printing
topgo_figure2 <- ggplot(all_results_w_go_descriptions, aes(x=dpi, y=GOTERM, fill=OoverALL)) +
geom_tile(width=1, height=1) +
scale_fill_gradient2(low = "white", mid = "pink", high = "red", midpoint = 0.03, space = "Lab", name = "Sig:Ann", breaks = c(0, 0.05, 0.1 ,0.15), labels = c("0.001", "0.05", "0.1", "0.15"), limits = c(0,0.15)) +
facet_grid(direction + domain ~ genotype, scales = "free_y", labeller = label_parsed) +
theme(
axis.text.x = element_text(size = 10, color="black"),
axis.title = element_text(size = 10),
axis.text.y = element_text(size=8, color="black"),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank(),
panel.grid.major = element_line(color = "gray"),
panel.grid.minor = element_blank(),
#panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill = "transparent", color = "white", size = 1),
#strip.text = element_text(face = "bold", size = 10, color = "black"),
strip.text = element_text(size = 10, color = "black"),
legend.position = "bottom",
legend.justification = "right",
legend.box = "horizontal",
#legend.box.background = element_rect(colour = "black"),
#legend.background = element_blank(),
panel.border = element_rect(color = "gray", fill = NA, size = 0.5),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
legend.background = element_rect(fill = "transparent"),
#legend.box.background = element_rect(fill = "transparent"),
legend.box.background=element_blank(),
legend.text=element_text(size=10),
legend.title=element_text(size=10),
strip.text.x=element_text(size=10),
legend.key.height = unit(0.1, "in"))
figure2_plot_more = ggplot_gtable(ggplot_build(topgo_figure2))
#gtable_show_layout(figure2_plot_more)
figure2_plot_more$heights[17] <- 0*figure2_plot_more$heights[17]
as_ggplot(figure2_plot_more)
ggsave(filename = "/Users/evahenningsen/Documents/GitHub/stem_rust_susceptibility/figure_2/Fig_2_GOSLIM_red.pdf", plot = figure2_plot_more, device = "pdf", width= 7.08, height=5, units = "in")
## For next time: fix font size and scale for printing
topgo_figure2 <- ggplot(all_results_w_go_descriptions, aes(x=dpi, y=GOTERM, fill=OoverALL)) +
geom_tile(width=1, height=1) +
scale_fill_gradient2(low = "white", mid = "pink", high = "red", midpoint = 0.03, space = "Lab", name = "Sig:Ann", breaks = c(-0.1, 0.05, 0.1 ,0.15), labels = c("0", "0.05", "0.1", "0.15"), limits = c(-0.1,0.15)) +
facet_grid(direction + domain ~ genotype, scales = "free_y", labeller = label_parsed) +
theme(
axis.text.x = element_text(size = 10, color="black"),
axis.title = element_text(size = 10),
axis.text.y = element_text(size=8, color="black"),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank(),
panel.grid.major = element_line(color = "gray"),
panel.grid.minor = element_blank(),
#panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill = "transparent", color = "white", size = 1),
#strip.text = element_text(face = "bold", size = 10, color = "black"),
strip.text = element_text(size = 10, color = "black"),
legend.position = "bottom",
legend.justification = "right",
legend.box = "horizontal",
#legend.box.background = element_rect(colour = "black"),
#legend.background = element_blank(),
panel.border = element_rect(color = "gray", fill = NA, size = 0.5),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
legend.background = element_rect(fill = "transparent"),
#legend.box.background = element_rect(fill = "transparent"),
legend.box.background=element_blank(),
legend.text=element_text(size=10),
legend.title=element_text(size=10),
strip.text.x=element_text(size=10),
legend.key.height = unit(0.1, "in"))
figure2_plot_more = ggplot_gtable(ggplot_build(topgo_figure2))
#gtable_show_layout(figure2_plot_more)
figure2_plot_more$heights[17] <- 0*figure2_plot_more$heights[17]
as_ggplot(figure2_plot_more)
## For next time: fix font size and scale for printing
topgo_figure2 <- ggplot(all_results_w_go_descriptions, aes(x=dpi, y=GOTERM, fill=OoverALL)) +
geom_tile(width=1, height=1) +
scale_fill_gradient2(low = "white", mid = "pink", high = "red", midpoint = 0.03, space = "Lab", name = "Sig:Ann", breaks = c(-0.01, 0.05, 0.1 ,0.15), labels = c("0", "0.05", "0.1", "0.15"), limits = c(-0.01,0.15)) +
facet_grid(direction + domain ~ genotype, scales = "free_y", labeller = label_parsed) +
theme(
axis.text.x = element_text(size = 10, color="black"),
axis.title = element_text(size = 10),
axis.text.y = element_text(size=8, color="black"),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank(),
panel.grid.major = element_line(color = "gray"),
panel.grid.minor = element_blank(),
#panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill = "transparent", color = "white", size = 1),
#strip.text = element_text(face = "bold", size = 10, color = "black"),
strip.text = element_text(size = 10, color = "black"),
legend.position = "bottom",
legend.justification = "right",
legend.box = "horizontal",
#legend.box.background = element_rect(colour = "black"),
#legend.background = element_blank(),
panel.border = element_rect(color = "gray", fill = NA, size = 0.5),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
legend.background = element_rect(fill = "transparent"),
#legend.box.background = element_rect(fill = "transparent"),
legend.box.background=element_blank(),
legend.text=element_text(size=10),
legend.title=element_text(size=10),
strip.text.x=element_text(size=10),
legend.key.height = unit(0.1, "in"))
figure2_plot_more = ggplot_gtable(ggplot_build(topgo_figure2))
#gtable_show_layout(figure2_plot_more)
figure2_plot_more$heights[17] <- 0*figure2_plot_more$heights[17]
as_ggplot(figure2_plot_more)
## For next time: fix font size and scale for printing
topgo_figure2 <- ggplot(all_results_w_go_descriptions, aes(x=dpi, y=GOTERM, fill=OoverALL)) +
geom_tile(width=1, height=1) +
scale_fill_gradient2(low = "white", mid = "pink", high = "red", midpoint = 0.03, space = "Lab", name = "Sig:Ann", breaks = c(0, 0.05, 0.1 ,0.15), labels = c("0", "0.05", "0.1", "0.15"), limits = c(0,0.15)) +
facet_grid(direction + domain ~ genotype, scales = "free_y", labeller = label_parsed) +
theme(
axis.text.x = element_text(size = 10, color="black"),
axis.title = element_text(size = 10),
axis.text.y = element_text(size=8, color="black"),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank(),
panel.grid.major = element_line(color = "gray"),
panel.grid.minor = element_blank(),
#panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill = "transparent", color = "white", size = 1),
#strip.text = element_text(face = "bold", size = 10, color = "black"),
strip.text = element_text(size = 10, color = "black"),
legend.position = "bottom",
legend.justification = "right",
legend.box = "horizontal",
#legend.box.background = element_rect(colour = "black"),
#legend.background = element_blank(),
panel.border = element_rect(color = "gray", fill = NA, size = 0.5),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
legend.background = element_rect(fill = "transparent"),
#legend.box.background = element_rect(fill = "transparent"),
legend.box.background=element_blank(),
legend.text=element_text(size=10),
legend.title=element_text(size=10),
strip.text.x=element_text(size=10),
legend.key.height = unit(0.1, "in"))
figure2_plot_more = ggplot_gtable(ggplot_build(topgo_figure2))
#gtable_show_layout(figure2_plot_more)
figure2_plot_more$heights[17] <- 0*figure2_plot_more$heights[17]
as_ggplot(figure2_plot_more)
ggsave(filename = "/Users/evahenningsen/Documents/GitHub/stem_rust_susceptibility/figure_2/Fig_2_GOSLIM_red.pdf", plot = figure2_plot_more, device = "pdf", width= 7.08, height=5, units = "in")
## For next time: fix font size and scale for printing
topgo_figure2 <- ggplot(all_results_w_go_descriptions, aes(x=dpi, y=GOTERM, fill=OoverALL)) +
geom_tile(width=1, height=1) +
scale_fill_gradient2(low = "white", mid = "grey", high = "black", midpoint = 0.03, space = "Lab", name = "Sig:Ann", breaks = c(0, 0.05, 0.1 ,0.15), labels = c("0", "0.05", "0.1", "0.15"), limits = c(0,0.15)) +
facet_grid(direction + domain ~ genotype, scales = "free_y", labeller = label_parsed) +
theme(
axis.text.x = element_text(size = 10, color="black"),
axis.title = element_text(size = 10),
axis.text.y = element_text(size=8, color="black"),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank(),
panel.grid.major = element_line(color = "gray"),
panel.grid.minor = element_blank(),
#panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill = "transparent", color = "white", size = 1),
#strip.text = element_text(face = "bold", size = 10, color = "black"),
strip.text = element_text(size = 10, color = "black"),
legend.position = "bottom",
legend.justification = "right",
legend.box = "horizontal",
#legend.box.background = element_rect(colour = "black"),
#legend.background = element_blank(),
panel.border = element_rect(color = "gray", fill = NA, size = 0.5),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
legend.background = element_rect(fill = "transparent"),
#legend.box.background = element_rect(fill = "transparent"),
legend.box.background=element_blank(),
legend.text=element_text(size=10),
legend.title=element_text(size=10),
strip.text.x=element_text(size=10),
legend.key.height = unit(0.1, "in"))
figure2_plot_more = ggplot_gtable(ggplot_build(topgo_figure2))
#gtable_show_layout(figure2_plot_more)
figure2_plot_more$heights[17] <- 0*figure2_plot_more$heights[17]
as_ggplot(figure2_plot_more)
ggsave(filename = "/Users/evahenningsen/Documents/GitHub/stem_rust_susceptibility/figure_2/Fig_2_GOSLIM_bw.pdf", plot = figure2_plot_more, device = "pdf", width= 7.08, height=5, units = "in")
ggsave(filename = "/Users/evahenningsen/Documents/GitHub/stem_rust_susceptibility/figure_2/Fig_2_GOSLIM_bw.tiff", plot = figure2_plot_more, device = "tiff", width= 7.08, height=5, units = "in")
## For next time: fix font size and scale for printing
topgo_figure2 <- ggplot(all_results_w_go_descriptions, aes(x=dpi, y=GOTERM, fill=OoverALL)) +
geom_tile(width=1, height=1) +
scale_fill_gradient2(low = "white", mid = "pink", high = "red", midpoint = 0.03, space = "Lab", name = "Sig:Ann", breaks = c(0, 0.05, 0.1 ,0.15), labels = c("0", "0.05", "0.1", "0.15"), limits = c(0,0.15)) +
facet_grid(direction + domain ~ genotype, scales = "free_y", labeller = label_parsed) +
theme(
axis.text.x = element_text(size = 10, color="black"),
axis.title = element_text(size = 10),
axis.text.y = element_text(size=8, color="black"),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank(),
panel.grid.major = element_line(color = "gray"),
panel.grid.minor = element_blank(),
#panel.background = element_rect(fill = "white"),
strip.background = element_rect(fill = "transparent", color = "white", size = 1),
#strip.text = element_text(face = "bold", size = 10, color = "black"),
strip.text = element_text(size = 10, color = "black"),
legend.position = "bottom",
legend.justification = "right",
legend.box = "horizontal",
#legend.box.background = element_rect(colour = "black"),
#legend.background = element_blank(),
panel.border = element_rect(color = "gray", fill = NA, size = 0.5),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
legend.background = element_rect(fill = "transparent"),
#legend.box.background = element_rect(fill = "transparent"),
legend.box.background=element_blank(),
legend.text=element_text(size=10),
legend.title=element_text(size=10),
strip.text.x=element_text(size=10),
legend.key.height = unit(0.1, "in"))
figure2_plot_more = ggplot_gtable(ggplot_build(topgo_figure2))
#gtable_show_layout(figure2_plot_more)
figure2_plot_more$heights[17] <- 0*figure2_plot_more$heights[17]
as_ggplot(figure2_plot_more)
ggsave(filename = "/Users/evahenningsen/Documents/GitHub/stem_rust_susceptibility/figure_2/Fig_2_GOSLIM_red.tiff", plot = figure2_plot_more, device = "tiff", width= 7.08, height=5, units = "in")
